{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CondoGest ‚Äî Dashboard</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-image: url('https://images.unsplash.com/photo-1501183638710-841dd1904471?q=80&w=1974');
      --glass: rgba(255,255,255,0.12);
      --glass-strong: rgba(255,255,255,0.18);
      --accent1: #38b6ff;
      --accent2: #7c3aed;
      --accent-soft: rgba(56,182,255,0.25);
      --danger: #ef4444;
      --success: #22c55e;
      --text: #f9fafb;
      --muted: rgba(229,231,235,0.85);
      --radius: 22px;
    }

    * {
      box-sizing: border-box;
    }

    body{
      margin:0;
      font-family:"Poppins",sans-serif;
      color: var(--text);
      min-height:100vh;
      background: radial-gradient(circle at top, #0f172a 0, #020617 45%, #020617 100%);
      position:relative;
      overflow-x:hidden;
    }

    body::before{
      content:"";
      position:fixed;
      inset:0;
      background:
        radial-gradient(circle at 20% 0%, rgba(56,182,255,0.22), transparent 55%),
        radial-gradient(circle at 80% 0%, rgba(124,58,237,0.28), transparent 60%);
      opacity:1;
      pointer-events:none;
      z-index:-2;
    }

    body::after{
      content:"";
      position:fixed;
      inset:0;
      background: url(https://grainy-gradients.vercel.app/noise.svg);
      opacity:.15;
      mix-blend-mode: soft-light;
      pointer-events:none;
      z-index:-1;
    }

    .page{
      max-width:1280px;
      margin:0 auto;
      padding:24px 18px 32px;
    }

    header.page-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:20px;
    }

    .logo-area{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .logo-box{
      width:38px;height:38px;border-radius:14px;
      background: radial-gradient(circle at 20% 0%, var(--accent1), var(--accent2));
      display:flex;align-items:center;justify-content:center;font-size:20px;
      box-shadow:0 10px 28px rgba(0,0,0,0.55);
    }
    .logo-text-title{
      margin:0;font-size:18px;font-weight:600;letter-spacing:.4px;
    }
    .logo-text-sub{
      margin:0;font-size:12px;color:var(--muted);
    }

    .header-meta{
      display:flex;align-items:center;gap:14px;font-size:12px;color:var(--muted);
    }
    .chip{
      padding:4px 10px;border-radius:999px;border:1px solid rgba(148,163,184,0.55);
      background:rgba(15,23,42,0.8);
      display:inline-flex;align-items:center;gap:6px;
    }
    .chip-dot{
      width:8px;height:8px;border-radius:999px;background:var(--success);box-shadow:0 0 10px rgba(34,197,94,0.85);
    }

    .app{
      display:grid;
      grid-template-columns: 260px minmax(0,1fr);
      gap:18px;
      align-items:flex-start;
    }

    @media (max-width: 900px){
      .app { grid-template-columns: 1fr; padding:16px; }
    }

    /* SIDEBAR */
    .sidebar {
      position:sticky;
      top:24px;
      height: calc(100vh - 48px);
      padding:18px;
      border-radius:var(--radius);
      background:var(--glass-strong);
      backdrop-filter: blur(12px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.45);
      display:flex;
      flex-direction:column;
      gap:18px;
      border:1px solid rgba(148,163,184,0.45);
    }

    .sidebar-header{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .sidebar-header img{
      width:38px;height:38px;border-radius:12px;object-fit:cover;
      border:1px solid rgba(148,163,184,0.75);
    }
    .sidebar-title{
      font-size:15px;font-weight:600;
    }
    .sidebar-sub{
      font-size:12px;color:var(--muted);
    }

    .nav {
      margin-top:6px;
      display:flex;
      flex-direction:column;
      gap:8px;
      flex:1;
      overflow:auto;
      padding-right:6px;
    }
    .nav button{
      display:flex;
      align-items:center;
      gap:10px;
      padding:12px;
      border-radius:10px;
      border:none;
      background:transparent;
      color:var(--muted);
      cursor:pointer;
      text-align:left;
      transition: background .18s, transform .12s;
      font-size:14px;
    }
    .nav button:hover{ background: rgba(255,255,255,0.04); transform: translateX(4px); color:var(--text) }
    .nav button.active{ background: linear-gradient(90deg,var(--accent1),var(--accent2)); color:#032033; font-weight:600; }

    .sidebar .footer {
      margin-top:12px;
      font-size:12px;
      color:var(--muted);
      border-top:1px solid rgba(148,163,184,0.4);
      padding-top:10px;
    }

    /* MAIN */
    .main{
      padding:18px 20px;
      border-radius:var(--radius);
      background:var(--glass);
      backdrop-filter: blur(14px);
      border:1px solid rgba(148,163,184,0.45);
      box-shadow: 0 16px 40px rgba(0,0,0,0.58);
      min-height:420px;
    }

    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:16px;
      margin-bottom:18px;
    }
    .topbar-title{
      display:flex;
      align-items:center;
      gap:8px;
    }
    .topbar-title h2{
      margin:0;
      font-size:18px;
    }
    .topbar-title span{
      font-size:12px;color:var(--muted);
    }

    .search {
      flex:1;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .search input{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      border:none;
      outline:none;
      background: rgba(255,255,255,0.92);
      color:#222;
    }
    .top-actions { display:flex; gap:8px; align-items:center; }

    .avatar{
      width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent1),var(--accent2));
      display:flex;align-items:center;justify-content:center;font-weight:700;color:#032033;
      box-shadow:0 6px 18px rgba(14,119,196,0.18);
    }

    /* GRID content */
    .grid {
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:18px;
    }
    @media (max-width:1100px){ .grid{ grid-template-columns: repeat(2,1fr);} }
    @media (max-width:768px){ .grid{ grid-template-columns:1fr;} }

    .card {
      padding:16px 16px 14px;
      border-radius:18px;
      background:var(--glass);
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 28px rgba(0,0,0,0.35);
      transition: transform .18s;
    }
    .card:hover{ transform: translateY(-6px); }

    .kpi { display:flex; justify-content:space-between; align-items:center; gap:12px; }
    .kpi .value{ font-size:22px; font-weight:700; }
    .kpi .label{ font-size:13px; color:rgba(255,255,255,0.9); }

    /* list / tables */
    .table {
      width:100%;
      border-collapse:collapse;
      margin-top:12px;
    }
    .table thead th { text-align:left; padding:10px 12px; font-size:13px; color:rgba(255,255,255,0.9) }
    .table tbody td { padding:10px 12px; font-size:14px; border-top:1px solid rgba(255,255,255,0.06) }

    .small-btn {
      padding:8px 10px;border-radius:8px;border:none;cursor:pointer;font-size:13px;
      background: rgba(255,255,255,0.08); color:var(--text);
    }
    .small-btn.edit{ background: linear-gradient(90deg,var(--accent1),var(--accent2)); color:#032033; }
    .small-btn.del{ background: rgba(224,74,74,0.95); color:white; }

    /* content sections (page switching) */
    .section { display:none; animation: fadeIn .28s ease forwards; }
    .section.active { display:block; }

    @keyframes fadeIn { from { opacity:0; transform: translateY(6px);} to { opacity:1; transform:translateY(0);} }

    /* responsive: collapsible sidebar button */
    .mobile-toggle {
      display:none;
      background:transparent;border:none;color:var(--text);font-size:20px;cursor:pointer;
    }
    @media (max-width:900px){
      .sidebar{ position:fixed; left:0; top:0; bottom:0; z-index:40; width:260px; transform: translateX(-110%); transition: transform .24s; padding-top:44px; }
      .sidebar.open{ transform: translateX(0); }
      .app { grid-template-columns: 1fr; }
      .mobile-toggle{ display:inline-flex; align-items:center; gap:8px; }
      .overlay { display:block; position:fixed; inset:0; background:rgba(15,23,42,0.55); z-index:30; opacity:0; pointer-events:none; transition:opacity .2s;}
      .overlay.show{ opacity:1; pointer-events:auto; }
    }

    /* footer small */
    footer.page-footer{ text-align:center; padding:18px; color:rgba(255,255,255,0.7) }

    /* helper */
    .muted{ color:rgba(255,255,255,0.85); font-size:13px }
    .row{ display:flex; gap:12px; align-items:center }
  </style>
</head>
<body>
  <div class="page">
    <header class="page-header">
      <div class="logo-area">
        <div class="logo-box">üè¢</div>
        <div>
          <p class="logo-text-title">CondoGest</p>
          <p class="logo-text-sub">Panel de administraci√≥n de condominios</p>
        </div>
      </div>
      <div class="header-meta">
        <div class="chip">
          <span class="chip-dot"></span>
          Servidor en l√≠nea
        </div>
        <span>Sesi√≥n iniciada como: <strong>{{ user.username|default:"Admin" }}</strong></span>
      </div>
    </header>

    <div class="app">
      <!-- SIDEBAR -->
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <img src="{% static 'images/login.png' %}" alt="logo">
          <div>
            <div class="sidebar-title">CondoGest</div>
            <div class="sidebar-sub">Sistema de Gesti√≥n de Condominios</div>
          </div>
        </div>

        <nav class="nav" role="navigation">
          <button class="nav-btn active" data-section="home">Dashboard</button>
          <button class="nav-btn" data-section="residentes">Residentes / Propietarios</button>
          <button class="nav-btn" data-section="pagos">Pagos y Cobros</button>
          <button class="nav-btn" data-section="tickets">Solicitudes / Tickets</button>
          <button class="nav-btn" data-section="personal">Personal & Proveedores</button>
          <button class="nav-btn" data-section="reuniones">Reuniones & Comunicaciones</button>
          <button class="nav-btn" data-section="seguridad">Control de Accesos</button>
          <button class="nav-btn" data-section="areas">√Åreas Comunes</button>
          <button class="nav-btn" data-section="reportes">Reportes & An√°lisis</button>
          <button class="nav-btn" data-section="documentacion">Documentaci√≥n</button>
        </nav>

        <div class="footer">
          <div class="muted">v1.0</div>
          <div style="font-size:12px;color:rgba(255,255,255,0.8)">Usuario: {{ user.username|default:"Admin" }}</div>
        </div>
      </aside>

      <!-- MAIN -->
      <main class="main">

        <!-- TOPBAR -->
        <div class="topbar">
          <div class="row">
            <button id="btnToggle" class="mobile-toggle" title="Abrir men√∫">‚ò∞</button>
            <div style="font-weight:600; font-size:18px">Dashboard</div>
          </div>

          <div style="display:flex; gap:12px; align-items:center;">
            <div class="search" style="max-width:420px">
              <input id="searchInput" placeholder="Buscar residentes, unidades, recibos...">
            </div>

            <div class="top-actions">
            <div class="avatar">{{ user.username|default:"U"|upper|slice:":1" }}</div>
            <div style="display:flex;flex-direction:column;align-items:flex-start;gap:2px;">
              <span style="font-size:13px;">{{ user.username|default:"Usuario" }}</span>
              <a href="{% url 'logout' %}" style="font-size:12px;color:#ffffff;text-decoration:none;opacity:0.9;">
                Cerrar sesi√≥n
              </a>
            </div>
          </div>
    
          </div>
        </div>

        <!-- SECTIONS: cada secci√≥n es una 'vista' est√°tica -->
        <section id="home" class="section active">
          <div class="grid">
            <div class="card">
              <div class="kpi">
                <div>
                  <div class="label muted">Ingresos del mes</div>
                  <div class="value">$148,920</div>
                </div>
                <div style="font-size:26px;opacity:0.95">üí≥</div>
              </div>
              <div style="margin-top:10px;font-size:13px;color:var(--muted)">
                Incluye cuotas de mantenimiento, estacionamiento y extras aprobados.
              </div>
            </div>

            <div class="card">
              <div class="kpi">
                <div>
                  <div class="label muted">Residentes activos</div>
                  <div class="value">312</div>
                </div>
                <div style="font-size:28px; opacity:0.95">üè†</div>
              </div>
              <div style="margin-top:10px; color:rgba(255,255,255,0.85)">Resumen de ocupaci√≥n y unidades.</div>
            </div>

            <div class="card">
              <div class="kpi">
                <div>
                  <div class="label muted">Morosidad</div>
                  <div class="value" style="color:#f97316;">18.4%</div>
                </div>
                <div style="font-size:26px;opacity:0.95">‚ö†Ô∏è</div>
              </div>
              <div style="margin-top:10px;font-size:13px;color:var(--muted)">
                Porcentaje de unidades con pagos atrasados en los √∫ltimos 60 d√≠as.
              </div>
            </div>
          </div>

          <div style="margin-top:20px; display:grid; grid-template-columns:2.1fr 1.3fr; gap:18px;">
            <div class="card">
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3 style="margin:0;font-size:15px;">Residentes recientes</h3>
                <button class="small-btn" onclick="fakeAddResident()">+ Agregar residente</button>
              </div>
              <table class="table" id="tblResidents">
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th>Unidad</th>
                    <th>Estatus</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Mar√≠a L√≥pez</td>
                    <td>Torre A - 302</td>
                    <td><span style="color:var(--success);font-size:13px;">Al corriente</span></td>
                    <td><button class="small-btn edit" onclick="fakeEdit(this)">Editar</button></td>
                  </tr>
                  <tr>
                    <td>Carlos G√≥mez</td>
                    <td>Torre B - 210</td>
                    <td><span style="color:#f97316;font-size:13px;">Atrasado</span></td>
                    <td><button class="small-btn edit" onclick="fakeEdit(this)">Editar</button></td>
                  </tr>
                  <tr>
                    <td>Familia Herrera</td>
                    <td>Torre C - PH</td>
                    <td><span style="color:var(--success);font-size:13px;">Al corriente</span></td>
                    <td><button class="small-btn edit" onclick="fakeEdit(this)">Editar</button></td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="card">
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3 style="margin:0;font-size:15px;">Pr√≥ximos eventos</h3>
                <button class="small-btn" onclick="fakeMeeting()">+ Agendar</button>
              </div>
              <ul style="list-style:none;padding-left:0;margin-top:12px;font-size:13px;">
                <li style="margin-bottom:6px;">
                  <strong>Asamblea general</strong> ‚Äî 22 Nov, 19:30 hrs
                  <div class="muted">Revisi√≥n de estados financieros y cuotas 2025.</div>
                </li>
                <li style="margin-bottom:6px;">
                  <strong>Mantenimiento elevadores</strong> ‚Äî 27 Nov, 9:00‚Äì14:00 hrs
                  <div class="muted">Se enviar√° aviso a residentes de Torre B.</div>
                </li>
                <li>
                  <strong>Junta comit√© de vigilancia</strong> ‚Äî 30 Nov, 18:00 hrs
                  <div class="muted">Revisi√≥n de incidencias y solicitudes de mejora.</div>
                </li>
              </ul>
            </div>
          </div>
        </section>

        <!-- secci√≥n residentes -->
        <section id="residentes" class="section">
          <div class="card">
            <h3 style="margin-top:0;font-size:15px;">Residentes / Propietarios</h3>
            <p class="muted">Aqu√≠ se mostrar√≠a el CRUD de residentes conectado a la base de datos.</p>
          </div>
        </section>

        <!-- secci√≥n pagos -->
        <section id="pagos" class="section">
          <div class="card">
            <h3 style="margin-top:0;font-size:15px;">Pagos y Cobros</h3>
            <p class="muted">Panel para registrar pagos, ver historial y descargar comprobantes.</p>
          </div>
        </section>

        <!-- secci√≥n tickets -->
        <section id="tickets" class="section">
          <div class="card">
            <h3 style="margin-top:0;font-size:15px;">Solicitudes / Tickets</h3>
            <p class="muted">Gesti√≥n de solicitudes de mantenimiento y seguimiento de incidencias.</p>
            <button class="small-btn" onclick="fakeCreateTicket()">+ Crear ticket</button>
          </div>
        </section>

        <!-- secci√≥n personal -->
        <section id="personal" class="section">
          <div class="card">
            <h3 style="margin-top:0;font-size:15px;">Personal & Proveedores</h3>
            <p class="muted">Registro y asignaci√≥n de tareas al personal interno y proveedores externos.</p>
          </div>
        </section>

        <!-- secci√≥n reuniones -->
        <section id="reuniones" class="section">
          <div class="card">
            <h3 style="margin-top:0;font-size:15px;">Reuniones & Comunicaciones</h3>
            <p class="muted">Historial de asambleas, comunicados y acuerdos importantes.</p>
          </div>
        </section>

        <!-- secci√≥n seguridad -->
        <section id="seguridad" class="section">
          <div class="card">
            <h3 style="margin-top:0;font-size:15px;">Control de Accesos</h3>
            <p class="muted">Resumen de accesos, visitas registradas y bit√°coras de seguridad.</p>
          </div>
        </section>

        <!-- secci√≥n √°reas comunes -->
        <section id="areas" class="section">
          <div class="card">
            <h3 style="margin-top:0;font-size:15px;">√Åreas Comunes</h3>
            <p class="muted">Reservas, calendario y reglas de uso de √°reas comunes.</p>
          </div>
        </section>

        <!-- secci√≥n reportes -->
        <section id="reportes" class="section">
          <div class="card">
            <h3 style="margin-top:0;font-size:15px;">Reportes & An√°lisis</h3>
            <p class="muted">Gr√°ficas y reportes financieros / operativos del condominio.</p>
          </div>
        </section>

        <!-- secci√≥n documentaci√≥n -->
        <section id="documentacion" class="section">
          <div class="card">
            <h3 style="margin-top:0;font-size:15px;">Documentaci√≥n</h3>
            <p class="muted">Reglamento interno, actas, contratos y documentos relevantes.</p>
          </div>
        </section>

      </main>
    </div>

    <footer class="page-footer">
      Proyecto acad√©mico ‚Äî CondoGest ¬∑ Panel de condominios
    </footer>
  </div>

  <div class="overlay" id="overlay" style="display:none;"></div>

  <script>
    // toggle secciones
    const navButtons = document.querySelectorAll('.nav-btn');
    const sections = document.querySelectorAll('.section');

    navButtons.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const target = btn.getAttribute('data-section');

        navButtons.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');

        sections.forEach(sec=>{
          if(sec.id === target){ sec.classList.add('active'); }
          else{ sec.classList.remove('active'); }
        });
      });
    });

    // mobile sidebar
    const sidebar = document.getElementById('sidebar');
    const btnToggle = document.getElementById('btnToggle');
    const overlay = document.getElementById('overlay');

    if(btnToggle){
      btnToggle.addEventListener('click', ()=>{
        const isOpen = sidebar.classList.toggle('open');
        overlay.style.display = 'block';
        overlay.classList.toggle('show', isOpen);
        if(!isOpen){
          setTimeout(()=>{ overlay.style.display='none'; }, 200);
        }
      });
    }

    if(overlay){
      overlay.addEventListener('click', ()=>{
        sidebar.classList.remove('open');
        overlay.classList.remove('show');
        setTimeout(()=>{ overlay.style.display='none'; }, 200);
      });
    }

    // fake actions demo
    function fakeAddResident(){
      alert('Aqu√≠ ir√≠a el formulario para agregar un residente (demo).');
    }
    function fakeMeeting(){
      alert('Aqu√≠ ir√≠a el m√≥dulo de reuniones (demo).');
    }
    function fakeEdit(btn){
      const row = btn.closest('tr');
      const name = row.children[0].innerText;
      const newName = prompt('Editar nombre del residente:', name);
      if(!newName) return;
      row.children[0].innerText = newName;
    }
    function fakeDelete(btn){
      if(!confirm('Eliminar registro? (simulado)')) return;
      const tr = btn.closest('tr'); tr.remove();
    }

    function fakeCreateTicket(){
      alert('Ticket creado (simulado).');
    }
    function fakeGenerateReceipt(){
      alert('Recibo generado (simulado).');
    }

    // quick search (client-side filter simple)
    document.getElementById('searchInput').addEventListener('input', (e)=>{
      const q = e.target.value.toLowerCase();
      // filter residents table for demo
      const rows = document.querySelectorAll('#tblResidents tbody tr');
      rows.forEach(r=>{
        r.style.display = (r.innerText.toLowerCase().includes(q)) ? '' : 'none';
      });
    });
  </script>
</body>
</html>
